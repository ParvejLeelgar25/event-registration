<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://axelor.com/xml/ns/object-views
  http://axelor.com/xml/ns/object-views/object-views_5.0.xsd">
  
  <grid model="com.axelor.event.registration.db.Event" title="Event" name="event-grid">
  	<field name="reference"/>
  </grid>
  
  <form model="com.axelor.event.registration.db.Event" title="Event" name="event-form" width="large" onSave="action-event-method-on-save">
  	<panel name="event-panel" title="Event">
  		<field name="reference"/>
  		<field name="address" form-view="address-form" canNew="true"/>
  		<field name="startDate" onChange="action-event-method-date-on-change" readonlyIf="eventRegistrationList.length > 0 || discountList.length > 0"/>
  		<field name="endDate" onChange="action-event-method-date-on-change" readonlyIf="eventRegistrationList.length > 0 || discountList.length > 0" />
  		<field name="registrationOpen" onChange="action-event-method-date-on-change" readonlyIf="eventRegistrationList.length > 0 || discountList.length > 0"/>
  		<field name="registrationClose" onChange="action-event-method-date-on-change" readonlyIf="eventRegistrationList.length > 0 || discountList.length > 0"/>
  		<field name="capacity" readonlyIf="eventRegistrationList.length > 0 || discountList.length > 0"/>
  		<field name="eventFees"/>
  		<field name="description" widget="html"/>
  		<field name="totalEntry"/>
  		<field name="amountCollected"/>
  		<field name="totalDiscount"/>
  	</panel>
  	
  	<panel-related field="eventRegistrationList" name="event-registration-list-panel" form-view="event-registration-form" grid-view="event-registration-grid" title="Event Registration" hidden="true" showIf="startDate != null &amp;&amp; endDate != null &amp;&amp; registrationOpen != null &amp;&amp; registrationClose != null"  onChange="action-event-attrs-event-registration-list-on-change"/>
  	
  	<panel-related field="discountList" name="discount-list-panel" form-view="discount-form" grid-view="discount-grid" title="Discount" hidden="true" showIf="startDate != null &amp;&amp; endDate != null &amp;&amp; registrationOpen != null &amp;&amp; registrationClose != null" onChange="action-event-method-discount-list-on-change"/>
  </form>
  
  <action-attrs name="action-event-attrs-event-registration-list-on-change">
  	<attribute name="value" for="totalEntry" expr="eval: eventRegistrationList.size()"/>
  </action-attrs>
  
  <action-method name="action-event-method-on-save">
  	<call class="com.axelor.event.registration.db.web.EventController" method="validation"/>
  </action-method>
  
  <action-method name="action-event-method-date-on-change">
  	<call class="com.axelor.event.registration.db.web.EventController" method="dateValidation"/>
  </action-method>
  
  <action-method name="action-event-method-discount-list-on-change">
  	<call class="com.axelor.event.registration.db.web.EventController" method="validationOnDiscountList"/>
  </action-method>
  
<!--   <action-validate name="action-event-validate-on-discount-list">
  	<error message="Exceed duration between open and close registration dates" if="java.time.temporal.ChronoUnit.DAYS.between(registrationOpen, registrationClose) &gt;= beforeDays" action="action-attr"/>
  </action-validate> -->
  
  </object-views>